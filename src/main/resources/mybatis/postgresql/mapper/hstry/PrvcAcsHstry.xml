<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="kr.or.kids.domain.hstry.mapper.PrvcAcsHstryMapper">

    <select id="getPrvcAcsHstry" parameterType="PrvcAcsHstryPVO" resultType="PrvcAcsHstryRVO" >
        /* 대국민포털_개인정보접근이력기본 조회 (PrvcAcsHstryMapper.getPrvcAcsHstry) */
        SELECT
             prvc_acs_sn
            ,inq_crtr_ymd
            ,srvc_cd
            ,menu_sn
            ,methods_nm
            ,inq_info
            ,rqstr_id
            ,rqstr_ip_addr
            ,inq_cnd
            ,inq_telgm
            ,rgtr_id
            ,reg_dt

            ,mdfr_id
            ,mdfcn_dt

        FROM kids_own.TB_PP_M_PRVC_ACS_HSTRY
        WHERE 1=1
        AND prvc_acs_sn = #{prvcAcsSn}
    </select>

    <insert id="insertPrvcAcsHstry" parameterType="PrvcAcsHstryPVO">
        /* 대국민포털_개인정보접근이력기본 입력 (PrvcAcsHstryMapper.insertPrvcAcsHstry) */
        INSERT INTO kids_own.TB_PP_M_PRVC_ACS_HSTRY
        (
             prvc_acs_sn
            ,inq_crtr_ymd
            ,srvc_cd
            ,menu_sn
            ,methods_nm
            ,inq_info
            ,rqstr_id
            ,rqstr_ip_addr
            ,inq_cnd
            ,inq_telgm
            ,rgtr_id
            ,reg_dt

            ,mdfr_id
            ,mdfcn_dt

        )
        VALUES
        (
             #{prvcAcsSn}
            ,#{inqCrtrYmd}
            ,#{srvcCd}
            ,#{menuSn}
            ,#{methodsNm}
            ,#{inqInfo}
            ,#{rqstrId}
            ,#{rqstrIpAddr}
            ,#{inqCnd}
            ,#{inqTelgm}
            ,#{rgtrId}
            ,now()

            ,#{mdfrId}
            ,now()

        )
    </insert>

    <update id="updatePrvcAcsHstry" parameterType="PrvcAcsHstryPVO">
        /* 대국민포털_개인정보접근이력기본 수정 (PrvcAcsHstryMapper.updatePrvcAcsHstry) */
        UPDATE kids_own.TB_PP_M_PRVC_ACS_HSTRY
        SET
             inq_crtr_ymd = coalesce(#{inqCrtrYmd}, inq_crtr_ymd)
            ,srvc_cd = coalesce(#{srvcCd}, srvc_cd)
            ,menu_sn = coalesce(#{menuSn}, menu_sn)
            ,methods_nm = coalesce(#{methodsNm}, methods_nm)
            ,inq_info = coalesce(#{inqInfo}, inq_info)
            ,rqstr_id = coalesce(#{rqstrId}, rqstr_id)
            ,rqstr_ip_addr = coalesce(#{rqstrIpAddr}, rqstr_ip_addr)
            ,inq_cnd = coalesce(#{inqCnd}, inq_cnd)
            ,inq_telgm = coalesce(#{inqTelgm}, inq_telgm)
            ,mdfr_id = coalesce(#{mdfrId}, mdfr_id)
            ,mdfcn_dt = now()

        WHERE 1=1
        AND prvc_acs_sn = #{prvcAcsSn}
    </update>

    <insert id="savePrvcAcsHstry" parameterType="PrvcAcsHstryPVO">
        /* 대국민포털_개인정보접근이력기본 저장 (PrvcAcsHstryMapper.insertPrvcAcsHstry) */
        INSERT INTO kids_own.TB_PP_M_PRVC_ACS_HSTRY
        (
             prvc_acs_sn
            ,inq_crtr_ymd
            ,srvc_cd
            ,menu_sn
            ,methods_nm
            ,inq_info
            ,rqstr_id
            ,rqstr_ip_addr
            ,inq_cnd
            ,inq_telgm
            ,rgtr_id
            ,reg_dt

            ,mdfr_id
            ,mdfcn_dt

        )
        VALUES
        (
             #{prvcAcsSn}
            ,#{inqCrtrYmd}
            ,#{srvcCd}
            ,#{menuSn}
            ,#{methodsNm}
            ,#{inqInfo}
            ,#{rqstrId}
            ,#{rqstrIpAddr}
            ,#{inqCnd}
            ,#{inqTelgm}
            ,#{rgtrId}
            ,now()

            ,#{mdfrId}
            ,now()

        )
        ON CONFLICT(prvc_acs_sn)
        DO UPDATE SET
             inq_crtr_ymd = coalesce(excluded.inq_crtr_ymd, kids_own.TB_PP_M_PRVC_ACS_HSTRY.inq_crtr_ymd)
            ,srvc_cd = coalesce(excluded.srvc_cd, kids_own.TB_PP_M_PRVC_ACS_HSTRY.srvc_cd)
            ,menu_sn = coalesce(excluded.menu_sn, kids_own.TB_PP_M_PRVC_ACS_HSTRY.menu_sn)
            ,methods_nm = coalesce(excluded.methods_nm, kids_own.TB_PP_M_PRVC_ACS_HSTRY.methods_nm)
            ,inq_info = coalesce(excluded.inq_info, kids_own.TB_PP_M_PRVC_ACS_HSTRY.inq_info)
            ,rqstr_id = coalesce(excluded.rqstr_id, kids_own.TB_PP_M_PRVC_ACS_HSTRY.rqstr_id)
            ,rqstr_ip_addr = coalesce(excluded.rqstr_ip_addr, kids_own.TB_PP_M_PRVC_ACS_HSTRY.rqstr_ip_addr)
            ,inq_cnd = coalesce(excluded.inq_cnd, kids_own.TB_PP_M_PRVC_ACS_HSTRY.inq_cnd)
            ,inq_telgm = coalesce(excluded.inq_telgm, kids_own.TB_PP_M_PRVC_ACS_HSTRY.inq_telgm)
            ,mdfr_id = coalesce(excluded.mdfr_id, kids_own.TB_PP_M_PRVC_ACS_HSTRY.mdfr_id)
            ,mdfcn_dt = now()

    </insert>

    <delete id="deletePrvcAcsHstry" parameterType="PrvcAcsHstryDVO">
        /* 대국민포털_개인정보접근이력기본 삭제 (PrvcAcsHstryMapper.deletePrvcAcsHstry) */
        DELETE FROM kids_own.TB_PP_M_PRVC_ACS_HSTRY
        WHERE 1=1
        AND prvc_acs_sn = #{prvcAcsSn}
    </delete>

</mapper>