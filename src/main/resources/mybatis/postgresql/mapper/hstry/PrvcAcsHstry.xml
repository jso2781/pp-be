<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="kr.go.kids.domain.pp.hstry.mapper.PrvcAcsHstryMapper">

    <select id="getPrvcAcsHstry" parameterType="PrvcAcsHstryPVO" resultType="PrvcAcsHstryRVO" >
        /* 대국민포털_개인정보접근이력기본 조회 (PrvcAcsHstryMapper.getPrvcAcsHstry) */
        SELECT
             prvc_acs_sn
            ,inq_crtr_ymd
            ,srvc_cd
            ,menu_sn
            ,methods_nm
            ,inq_info
            ,rqstr_id
            ,rqstr_ip_addr
            ,inq_cnd
            ,inq_telgm
            ,rgtr_id
            ,reg_dt
            ,reg_prgrm_id
            ,mdfr_id
            ,mdfcn_dt
            ,mdfcn_prgrm_id
        FROM "KIDS_OWN"."TB_PP_M_PRVC_ACS_HSTRY"
        WHERE 1=1
        AND prvc_acs_sn = #{prvcAcsSn}
    </select>

    <insert id="insertPrvcAcsHstry" parameterType="PrvcAcsHstryPVO">
        /* 대국민포털_개인정보접근이력기본 입력 (PrvcAcsHstryMapper.insertPrvcAcsHstry) */
        INSERT INTO "KIDS_OWN"."TB_PP_M_PRVC_ACS_HSTRY"
        (
             prvc_acs_sn
            ,inq_crtr_ymd
            ,srvc_cd
            ,menu_sn
            ,methods_nm
            ,inq_info
            ,rqstr_id
            ,rqstr_ip_addr
            ,inq_cnd
            ,inq_telgm
            ,rgtr_id
            ,reg_dt
            ,reg_prgrm_id
            ,mdfr_id
            ,mdfcn_dt
            ,mdfcn_prgrm_id
        )
        VALUES
        (
             #{prvcAcsSn}
            ,#{inqCrtrYmd}
            ,#{srvcCd}
            ,#{menuSn}
            ,#{methodsNm}
            ,#{inqInfo}
            ,#{rqstrId}
            ,#{rqstrIpAddr}
            ,#{inqCnd}
            ,#{inqTelgm}
            ,#{rgtrId}
            ,now()
            ,#{regPrgrmId}
            ,#{mdfrId}
            ,now()
            ,#{mdfcnPrgrmId}
        )
    </insert>

    <update id="updatePrvcAcsHstry" parameterType="PrvcAcsHstryPVO">
        /* 대국민포털_개인정보접근이력기본 수정 (PrvcAcsHstryMapper.updatePrvcAcsHstry) */
        UPDATE "KIDS_OWN"."TB_PP_M_PRVC_ACS_HSTRY"
        SET
             inq_crtr_ymd = coalesce(#{inqCrtrYmd}, inq_crtr_ymd)
            ,srvc_cd = coalesce(#{srvcCd}, srvc_cd)
            ,menu_sn = coalesce(#{menuSn}, menu_sn)
            ,methods_nm = coalesce(#{methodsNm}, methods_nm)
            ,inq_info = coalesce(#{inqInfo}, inq_info)
            ,rqstr_id = coalesce(#{rqstrId}, rqstr_id)
            ,rqstr_ip_addr = coalesce(#{rqstrIpAddr}, rqstr_ip_addr)
            ,inq_cnd = coalesce(#{inqCnd}, inq_cnd)
            ,inq_telgm = coalesce(#{inqTelgm}, inq_telgm)
            ,mdfr_id = coalesce(#{mdfrId}, mdfr_id)
            ,mdfcn_dt = now()
            ,mdfcn_prgrm_id = coalesce(#{mdfcnPrgrmId}, mdfcn_prgrm_id)
        WHERE 1=1
        AND prvc_acs_sn = #{prvcAcsSn}
    </update>

    <insert id="savePrvcAcsHstry" parameterType="PrvcAcsHstryPVO">
        /* 대국민포털_개인정보접근이력기본 저장 (PrvcAcsHstryMapper.insertPrvcAcsHstry) */
        INSERT INTO "KIDS_OWN"."TB_PP_M_PRVC_ACS_HSTRY"
        (
             prvc_acs_sn
            ,inq_crtr_ymd
            ,srvc_cd
            ,menu_sn
            ,methods_nm
            ,inq_info
            ,rqstr_id
            ,rqstr_ip_addr
            ,inq_cnd
            ,inq_telgm
            ,rgtr_id
            ,reg_dt
            ,reg_prgrm_id
            ,mdfr_id
            ,mdfcn_dt
            ,mdfcn_prgrm_id
        )
        VALUES
        (
             #{prvcAcsSn}
            ,#{inqCrtrYmd}
            ,#{srvcCd}
            ,#{menuSn}
            ,#{methodsNm}
            ,#{inqInfo}
            ,#{rqstrId}
            ,#{rqstrIpAddr}
            ,#{inqCnd}
            ,#{inqTelgm}
            ,#{rgtrId}
            ,now()
            ,#{regPrgrmId}
            ,#{mdfrId}
            ,now()
            ,#{mdfcnPrgrmId}
        )
        ON CONFLICT(prvc_acs_sn)
        DO UPDATE SET
             inq_crtr_ymd = coalesce(excluded.inq_crtr_ymd, "KIDS_OWN"."TB_PP_M_PRVC_ACS_HSTRY".inq_crtr_ymd)
            ,srvc_cd = coalesce(excluded.srvc_cd, "KIDS_OWN"."TB_PP_M_PRVC_ACS_HSTRY".srvc_cd)
            ,menu_sn = coalesce(excluded.menu_sn, "KIDS_OWN"."TB_PP_M_PRVC_ACS_HSTRY".menu_sn)
            ,methods_nm = coalesce(excluded.methods_nm, "KIDS_OWN"."TB_PP_M_PRVC_ACS_HSTRY".methods_nm)
            ,inq_info = coalesce(excluded.inq_info, "KIDS_OWN"."TB_PP_M_PRVC_ACS_HSTRY".inq_info)
            ,rqstr_id = coalesce(excluded.rqstr_id, "KIDS_OWN"."TB_PP_M_PRVC_ACS_HSTRY".rqstr_id)
            ,rqstr_ip_addr = coalesce(excluded.rqstr_ip_addr, "KIDS_OWN"."TB_PP_M_PRVC_ACS_HSTRY".rqstr_ip_addr)
            ,inq_cnd = coalesce(excluded.inq_cnd, "KIDS_OWN"."TB_PP_M_PRVC_ACS_HSTRY".inq_cnd)
            ,inq_telgm = coalesce(excluded.inq_telgm, "KIDS_OWN"."TB_PP_M_PRVC_ACS_HSTRY".inq_telgm)
            ,mdfr_id = coalesce(excluded.mdfr_id, "KIDS_OWN"."TB_PP_M_PRVC_ACS_HSTRY".mdfr_id)
            ,mdfcn_dt = now()
            ,mdfcn_prgrm_id = coalesce(excluded.mdfcn_prgrm_id, "KIDS_OWN"."TB_PP_M_PRVC_ACS_HSTRY".mdfcn_prgrm_id)
    </insert>

    <delete id="deletePrvcAcsHstry" parameterType="PrvcAcsHstryDVO">
        /* 대국민포털_개인정보접근이력기본 삭제 (PrvcAcsHstryMapper.deletePrvcAcsHstry) */
        DELETE FROM "KIDS_OWN"."TB_PP_M_PRVC_ACS_HSTRY"
        WHERE 1=1
        AND prvc_acs_sn = #{prvcAcsSn}
    </delete>

</mapper>